<html>
    <head><title>Load image</title></head>
    
    <body>
        <style>img{ height: 200px; width: 200px; border: 2px solid black; }</style>

        Image name <input id="namebox" type="text"> <br><br>
        <img id="myimg"> <label id="upProgress"></label> <br><br>



        <button id="select">Select Image</button>
        <button id="upload">Upload Image</button>


        <img id="retrive" src="">
        <img id="retrive2" src="">

        <!--------------------------FIRBASE LIBRARIES-------------------------------------------------->
<script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-database.js"></script> 
<script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-storage.js"></script> 

<script id="MainScript">

    var ImgName, ImgUrl;
    var files = [];
    var reader = new FileReader();


    const firebaseConfig = {
  apiKey: "AIzaSyAnP4Gl9eCxIwp7xVspDH-6a4PUJbbhiKk",
  authDomain: "test-image-64bee.firebaseapp.com",
  projectId: "test-image-64bee",
  storageBucket: "test-image-64bee.appspot.com",
  messagingSenderId: "45858459106",
  appId: "1:45858459106:web:2747bb28556ec2c398bdbb",
  measurementId: "G-DFW867H26R"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

document.getElementById("select").onclick = function(e){

    var input = document.createElement('input');
    input.type= 'file';
   
    input.onchange = e => {
        files = e.target.files;
        reader = new FileReader();
        reader.onload = function(){
            document.getElementById("myimg").src = reader.result;
        }
        reader.readAsDataURL(files[0]);
    }
    input.click();

}

//----upload process---//


//--uploading picture--//
document.getElementById('upload').onclick = function(){
    ImgName = document.getElementById('namebox').value;
    var uploadTask = firebase.storage().ref('Images/'+ImgName+".png").put(files[0]);

    uploadTask.on('state_changed', function(snapshot){
        var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
        document.getElementById('upProgress').innerHTML = 'Upload'+progress+'%';
    },
        function(error){
            alert('error in saving image');
        },

        function(){
           uploadTask.snapshot.ref.getDownloadURL().then(function(url){
            ImgUrl = url;
           
            firebase.database().ref('Pictures/'+ImgName).set({
                Name: ImgName,
                Link: ImgUrl
           });
        alert('image added');
    }
    );
}) ;
}

imgname = 'hhhh';
firebase.database().ref('Pictures/'+imgname).on('value', function(snapshot){
document.getElementById('retrive').src = snapshot.val().Link;
});

imgname1 = 'gots';
firebase.database().ref('Pictures/'+imgname1).on('value', function(snapshot){
document.getElementById('retrive').src = snapshot.val().Link;
});


</script>


    </body>

</html>